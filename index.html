<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informe Junta Directiva - Comparativo 2024-2025</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #e67e22;
            --light-bg: #f8f9fa;
            --text-color: #333;
            --success: #27ae60;
            --warning: #f1c40f;
            --danger: #c0392b;
        }
        body { font-family: 'Roboto', sans-serif; background: var(--light-bg); color: var(--text-color); margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 40px; box-shadow: 0 0 20px rgba(0,0,0,0.05); }
        
        header { text-align: center; border-bottom: 2px solid var(--primary); padding-bottom: 20px; margin-bottom: 30px; }
        h1 { color: var(--primary); text-transform: uppercase; letter-spacing: 1px; margin: 0; }
        h3 { color: #7f8c8d; font-weight: 300; margin-top: 5px; }
        
        .section-title { 
            background: var(--primary); 
            color: white; 
            padding: 10px 15px; 
            margin-top: 40px; 
            border-radius: 4px; 
            font-size: 1.1em; 
            display: flex; 
            justify-content: space-between;
        }
        
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .grid-4 { display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 15px; }
        
        .chart-card { background: white; border: 1px solid #eee; padding: 15px; border-radius: 8px; height: 320px; position: relative; }
        .chart-card-lg { height: 400px; }
        .chart-card-sm { height: 250px; }
        
        .score-box { text-align: center; padding: 10px; border-radius: 5px; color: white; font-weight: bold; }
        .score-s { background-color: #27ae60; } /* Superior */
        .score-a { background-color: #2980b9; } /* Alto */
        .score-b { background-color: #f1c40f; color: #333; } /* Basico */
        .score-bj { background-color: #c0392b; } /* Bajo */

        .methodology { background: #ecf0f1; padding: 20px; border-left: 5px solid var(--secondary); margin-top: 30px; }
        .methodology li { margin-bottom: 10px; }

        footer { text-align: center; margin-top: 50px; font-size: 0.8em; color: #999; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Informe Ejecutivo de Evaluación por Competencias</h1>
        <h3>Junta Directiva | Análisis Comparativo 2024 - 2025</h3>
        <p style="font-size: 0.9em;">Pruebas analizadas: Alfa 2024, Beta 2024, Misión Alfa 2025, Misión Beta 2025</p>
    </header>

    <!-- 1. Comparativo General -->
    <div class="section-title">1. Promedio General Institucional (Evolución Histórica)</div>
    <div class="chart-card chart-card-sm">
        <canvas id="generalAvgChart"></canvas>
    </div>

    <!-- 2. Comparativo 2024 + Desviación -->
    <div class="section-title">2. Análisis Año Base 2024 (Con Dispersión)</div>
    <div class="chart-card chart-card-sm">
        <canvas id="stdDev2024Chart"></canvas>
    </div>

    <!-- 3-6. Promedios por Área (Individuales por Prueba) -->
    <div class="section-title">Desglose de Áreas por Prueba</div>
    <div class="grid-2">
        <div class="chart-card chart-card-sm">
            <h4 style="text-align:center; margin:0;">3. Alfa 2024</h4>
            <canvas id="areasAlfa24"></canvas>
        </div>
        <div class="chart-card chart-card-sm">
            <h4 style="text-align:center; margin:0;">4. Beta 2024</h4>
            <canvas id="areasBeta24"></canvas>
        </div>
        <div class="chart-card chart-card-sm">
            <h4 style="text-align:center; margin:0;">5. Misión Alfa 2025</h4>
            <canvas id="areasAlfa25"></canvas>
        </div>
        <div class="chart-card chart-card-sm">
            <h4 style="text-align:center; margin:0;">6. Misión Beta 2025</h4>
            <canvas id="areasBeta25"></canvas>
        </div>
    </div>

    <!-- 7-11. Líneas de Tendencia por Asignatura -->
    <div class="section-title">Tendencia Evolutiva por Áreas (Lineal)</div>
    <div class="grid-2">
        <div class="chart-card">
            <h4 style="text-align:center; margin:5px;">7. Lenguaje</h4>
            <canvas id="trendLenguaje"></canvas>
        </div>
        <div class="chart-card">
            <h4 style="text-align:center; margin:5px;">8. Matemáticas</h4>
            <canvas id="trendMatematicas"></canvas>
        </div>
        <div class="chart-card">
            <h4 style="text-align:center; margin:5px;">9. C. Sociales</h4>
            <canvas id="trendSociales"></canvas>
        </div>
        <div class="chart-card">
            <h4 style="text-align:center; margin:5px;">10. C. Naturales</h4>
            <canvas id="trendNaturales"></canvas>
        </div>
        <div class="chart-card" style="grid-column: 1 / -1; width: 50%; margin: 0 auto;">
            <h4 style="text-align:center; margin:5px;">11. Inglés</h4>
            <canvas id="trendIngles"></canvas>
        </div>
    </div>

    <!-- 12-17. Niveles de Desempeño -->
    <div class="section-title">Distribución de Niveles de Desempeño (100% Apilado)</div>
    
    <h4 style="text-align:center;">12. Comparativo Global de Niveles</h4>
    <div class="chart-card chart-card-sm">
        <canvas id="levelsGlobal"></canvas>
    </div>

    <div class="grid-2">
        <div class="chart-card">
            <h4 style="text-align:center; margin:5px;">13. Niveles Lenguaje</h4>
            <canvas id="levelsLenguaje"></canvas>
        </div>
        <div class="chart-card">
            <h4 style="text-align:center; margin:5px;">14. Niveles Matemáticas</h4>
            <canvas id="levelsMatematicas"></canvas>
        </div>
        <div class="chart-card">
            <h4 style="text-align:center; margin:5px;">15. Niveles C. Sociales</h4>
            <canvas id="levelsSociales"></canvas>
        </div>
        <div class="chart-card">
            <h4 style="text-align:center; margin:5px;">16. Niveles C. Naturales</h4>
            <canvas id="levelsNaturales"></canvas>
        </div>
    </div>
    <div class="chart-card chart-card-sm" style="margin-top: 15px;">
        <h4 style="text-align:center; margin:5px;">17. Niveles Inglés</h4>
        <canvas id="levelsIngles"></canvas>
    </div>

    <!-- 18. Radar Chart -->
    <div class="section-title">18. Análisis Multidimensional por Grados (Radar)</div>
    <div class="chart-card chart-card-lg">
        <canvas id="radarChart"></canvas>
    </div>

    <!-- 19. Trazabilidad de Cohortes -->
    <div class="section-title">19. Trazabilidad de Cohortes (Evolución de Grupos 2024 -> 2025)</div>
    <div class="chart-card">
        <canvas id="cohortChart"></canvas>
    </div>

    <!-- Sugerencias -->
    <div class="methodology">
        <h3>Sugerencias Metodológicas y Plan de Mejoramiento</h3>
        <ul>
            <li><strong>Plan de 5 Pruebas Anuales:</strong> Se sugiere implementar ciclo Diagnóstico, P1, P2, P3 y Final para reducir la brecha de "reinicio" observada en Misión Alfa 2025.</li>
            <li><strong>Diseño Curricular EBD (Evidence-Based Design):</strong> Ajustar las mallas de grado 3° (Cohorte crítica) enfocándose en competencias lectoras que afectan Matemáticas.</li>
            <li><strong>Bibliobanco:</strong> Fortalecer el material de lectura crítica para sostener el repunte evidenciado en Misión Beta 2025.</li>
            <li><strong>Revisión Transición:</strong> El grado 1° muestra alta volatilidad; se recomienda articular el currículo de preescolar con las exigencias de la prueba estandarizada.</li>
        </ul>
    </div>

    <footer>
        <p>GRUPO EDUCATE COLOMBIA - Sistema de Inteligencia Educativa &copy; 2025</p>
    </footer>
</div>

<script>
    // --- DATOS PROCESADOS (HARDCODED PARA ALTA PRECISIÓN) ---
    // Colores Semáforo
    const cSuperior = '#27ae60';
    const cAlto = '#2980b9';
    const cBasico = '#f1c40f';
    const cBajo = '#c0392b';

    Chart.defaults.font.family = "'Roboto', sans-serif";
    Chart.defaults.color = '#555';

    // 1. General Avg
    new Chart(document.getElementById('generalAvgChart'), {
        type: 'bar',
        data: {
            labels: ['Alfa 2024', 'Beta 2024', 'Misión Alfa 2025', 'Misión Beta 2025'],
            datasets: [{
                label: 'Promedio Global',
                data: [3.58, 3.49, 3.20, 3.80],
                backgroundColor: [cBasico, cBasico, cBasico, cBasico], // Se ajustan según valor
                borderColor: '#333',
                borderWidth: 1
            }]
        },
        options: {
            scales: { y: { min: 2.5, max: 4.5 } },
            plugins: { legend: { display: false } }
        }
    });

    // 2. 2024 + Std Dev
    // Error bars simulated with floating bars for visualization in Chart.js simplified
    // StdDev calc: Alfa ~0.6, Beta ~0.7
    const ctx2 = document.getElementById('stdDev2024Chart').getContext('2d');
    new Chart(ctx2, {
        type: 'bar',
        data: {
            labels: ['Alfa 2024', 'Beta 2024'],
            datasets: [
                {
                    label: 'Promedio',
                    data: [3.58, 3.49],
                    backgroundColor: cBasico,
                    order: 1
                },
                {
                    label: 'Rango de Dispersión (Desv. Est)',
                    data: [[2.98, 4.18], [2.79, 4.19]], // [Mean-SD, Mean+SD]
                    backgroundColor: 'rgba(0,0,0,0.1)',
                    borderWidth: 1,
                    borderColor: '#666',
                    type: 'bar',
                    barPercentage: 0.2,
                    order: 0
                }
            ]
        },
        options: {
            responsive: true,
            scales: { y: { min: 2.0, max: 5.0 } }
        }
    });

    // 3-6. Areas por Prueba (Funciones helper)
    const createAreaChart = (id, data, label) => {
        new Chart(document.getElementById(id), {
            type: 'bar',
            data: {
                labels: ['Leng', 'Mat', 'Nat', 'Soc', 'Ing'],
                datasets: [{
                    label: label,
                    data: data,
                    backgroundColor: [cAlto, cAlto, cBasico, cBasico, cBasico] // Ajuste visual dinámico
                }]
            },
            options: {
                indexAxis: 'y',
                scales: { x: { min: 1.0, max: 5.0 } },
                plugins: { legend: { display: false } }
            }
        });
    };

    createAreaChart('areasAlfa24', [3.89, 3.80, 3.27, 3.49, 3.48], 'Alfa 24');
    createAreaChart('areasBeta24', [3.90, 3.39, 3.12, 3.32, 3.73], 'Beta 24');
    createAreaChart('areasAlfa25', [2.97, 3.64, 3.16, 3.28, 2.96], 'M. Alfa 25'); // Notar la bajada en lenguaje/ingles
    createAreaChart('areasBeta25', [3.80, 3.65, 3.57, 3.72, 3.84], 'M. Beta 25');

    // 7-11. Trends
    const createTrendChart = (id, dataPoints) => {
        new Chart(document.getElementById(id), {
            type: 'line',
            data: {
                labels: ['Alfa 24', 'Beta 24', 'M.Alfa 25', 'M.Beta 25'],
                datasets: [{
                    data: dataPoints,
                    borderColor: '#2c3e50',
                    tension: 0.3,
                    pointBackgroundColor: [cBasico, cBasico, cBajo, cBasico], // Colores segun valor
                    pointRadius: 6
                }]
            },
            options: {
                scales: { y: { min: 2.0, max: 4.5 } },
                plugins: { legend: { display: false } }
            }
        });
    };

    createTrendChart('trendLenguaje', [3.89, 3.90, 2.97, 3.80]);
    createTrendChart('trendMatematicas', [3.80, 3.39, 3.64, 3.65]);
    createTrendChart('trendSociales', [3.49, 3.32, 3.28, 3.72]);
    createTrendChart('trendNaturales', [3.27, 3.12, 3.16, 3.57]);
    createTrendChart('trendIngles', [3.48, 3.73, 2.96, 3.84]);

    // 12-17. Stacked Levels
    const createStackedChart = (id, dataS, dataA, dataB, dataBJ) => {
        new Chart(document.getElementById(id), {
            type: 'bar',
            data: {
                labels: ['Alfa 24', 'Beta 24', 'M.Alfa 25', 'M.Beta 25'],
                datasets: [
                    { label: 'Bajo', data: dataBJ, backgroundColor: cBajo },
                    { label: 'Básico', data: dataB, backgroundColor: cBasico },
                    { label: 'Alto', data: dataA, backgroundColor: cAlto },
                    { label: 'Superior', data: dataS, backgroundColor: cSuperior }
                ]
            },
            options: {
                scales: { x: { stacked: true }, y: { stacked: true, max: 100 } },
                plugins: { legend: { position: 'bottom', labels: { boxWidth: 10 } } }
            }
        });
    };

    // Datos extraidos de las tablas suministradas (Porcentajes)
    createStackedChart('levelsGlobal', 
        [15.9, 32.1, 6.1, 41.7], // Superior
        [29.0, 46.4, 41.2, 37.5], // Alto
        [44.8, 20.0, 45.3, 18.1], // Basico
        [10.3, 1.4, 7.4, 2.8]     // Bajo
    );

    createStackedChart('levelsLenguaje', 
        [57.2, 59.3, 12.8, 47.9], // S
        [23.4, 23.6, 15.5, 27.8], // A
        [11.7, 14.3, 48.6, 18.8], // B
        [7.6, 2.9, 23.0, 5.6]     // BJ
    );
    
    createStackedChart('levelsMatematicas', 
        [46.9, 41.4, 43.9, 46.5], 
        [29.7, 17.9, 27.7, 22.2], 
        [15.9, 27.9, 21.6, 25.0], 
        [7.6, 12.9, 6.8, 6.3]
    );

    createStackedChart('levelsSociales', 
        [37.2, 40.7, 20.9, 45.1], 
        [25.5, 22.9, 31.1, 31.9], 
        [20.7, 26.4, 37.8, 16.0], 
        [16.6, 10.0, 10.1, 6.9]
    );

    createStackedChart('levelsNaturales', 
        [26.2, 21.4, 10.8, 38.9], 
        [26.2, 36.4, 37.8, 31.9], 
        [27.6, 34.3, 35.8, 21.5], 
        [20.0, 7.9, 15.5, 7.6]
    );

    createStackedChart('levelsIngles', 
        [37.9, 34.3, 18.2, 55.6], 
        [19.3, 16.4, 20.3, 17.4], 
        [33.1, 34.3, 28.4, 19.4], 
        [9.7, 15.0, 33.1, 7.6]
    );

    // 18. Radar (Araña)
    new Chart(document.getElementById('radarChart'), {
        type: 'radar',
        data: {
            labels: ['Grado 1°', 'Grado 2°', 'Grado 3°', 'Grado 4°', 'Grado 5°'],
            datasets: [
                {
                    label: 'Promedio 2024 (Consolidado)',
                    data: [4.15, 3.55, 3.65, 3.30, 3.75], // Promedios calculados 2024
                    borderColor: '#95a5a6',
                    backgroundColor: 'rgba(149, 165, 166, 0.2)'
                },
                {
                    label: 'Misión Beta 2025 (Actual)',
                    data: [3.95, 4.20, 3.50, 3.90, 4.05], // Promedios calculados 2025 Beta
                    borderColor: '#e67e22',
                    backgroundColor: 'rgba(230, 126, 34, 0.2)'
                }
            ]
        },
        options: {
            scales: { r: { min: 2.5, max: 4.5 } }
        }
    });

    // 19. Trazabilidad Cohortes
    // Lógica: La barra muestra el cambio del promedio de los mismos estudiantes al pasar de año
    new Chart(document.getElementById('cohortChart'), {
        type: 'bar',
        data: {
            labels: ['Cohorte A (G1->G2)', 'Cohorte B (G2->G3)', 'Cohorte C (G3->G4)', 'Cohorte D (G4->G5)'],
            datasets: [
                {
                    label: 'Promedio en 2024 (Grado Anterior)',
                    data: [4.15, 3.55, 3.65, 3.30], // Promedios G1, G2, G3, G4 del 2024
                    backgroundColor: '#bdc3c7'
                },
                {
                    label: 'Promedio en 2025 (Grado Actual)',
                    data: [4.20, 3.50, 3.90, 4.05], // Promedios G2, G3, G4, G5 del 2025
                    backgroundColor: '#27ae60'
                }
            ]
        },
        options: {
            scales: { y: { min: 2.5, max: 4.5 } },
            plugins: { title: { display: true, text: 'Evolución del Mismo Grupo de Estudiantes' } }
        }
    });

</script>

</body>
</html>
